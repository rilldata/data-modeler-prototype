swagger: "2.0"
info:
  title: rill/admin/v1/api.proto
  version: version not set
tags:
  - name: AdminService
consumes:
  - application/json
produces:
  - application/json
paths:
  /v1/github/repositories:
    get:
      summary: |-
        GetGithubRepoRequest returns info about a Github repo based on the caller's installations.
        If the caller has not granted access to the repository, instructions for granting access are returned.
      operationId: AdminService_GetGithubRepoStatus
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetGithubRepoStatusResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: githubUrl
          in: query
          required: false
          type: string
      tags:
        - AdminService
  /v1/organizations:
    get:
      summary: ListOrganizations lists all the organizations currently managed by the admin
      operationId: AdminService_ListOrganizations
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListOrganizationsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int64
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - AdminService
    post:
      summary: CreateOrganization creates a new organization
      operationId: AdminService_CreateOrganization
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateOrganizationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateOrganizationRequest'
      tags:
        - AdminService
  /v1/organizations/{name}:
    get:
      summary: GetOrganization returns information about a specific organization
      operationId: AdminService_GetOrganization
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetOrganizationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: name
          in: path
          required: true
          type: string
      tags:
        - AdminService
    delete:
      summary: DeleteOrganization deletes an organizations
      operationId: AdminService_DeleteOrganization
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1DeleteOrganizationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: name
          in: path
          required: true
          type: string
      tags:
        - AdminService
    put:
      summary: UpdateOrganization deletes an organizations
      operationId: AdminService_UpdateOrganization
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1UpdateOrganizationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: name
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              description:
                type: string
      tags:
        - AdminService
  /v1/organizations/{organization}/members:
    get:
      summary: ListOrganizationMembers lists all the org members
      operationId: AdminService_ListOrganizationMembers
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListOrganizationMembersResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organization
          in: path
          required: true
          type: string
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int64
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - AdminService
    post:
      summary: AddOrganizationMember lists all the org members
      operationId: AdminService_AddOrganizationMember
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1AddOrganizationMemberResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organization
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              email:
                type: string
              role:
                type: string
            title: Request message for AdminService.AddOrganizationMember
      tags:
        - AdminService
  /v1/organizations/{organization}/members/{email}:
    delete:
      summary: RemoveOrganizationMember removes member from the organization
      operationId: AdminService_RemoveOrganizationMember
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1RemoveOrganizationMemberResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organization
          in: path
          required: true
          type: string
        - name: email
          in: path
          required: true
          type: string
      tags:
        - AdminService
    put:
      summary: SetOrganizationMemberRole sets the role for the member
      operationId: AdminService_SetOrganizationMemberRole
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1SetOrganizationMemberRoleResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organization
          in: path
          required: true
          type: string
        - name: email
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              role:
                type: string
            title: Request message for AdminService.SetOrganizationMemberRole
      tags:
        - AdminService
  /v1/organizations/{organization}/members/current:
    delete:
      summary: LeaveOrganization removes the current user from the organization
      operationId: AdminService_LeaveOrganization
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1LeaveOrganizationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organization
          in: path
          required: true
          type: string
      tags:
        - AdminService
  /v1/organizations/{organization}/projects/{project}/members:
    get:
      summary: ListProjectMembers lists all the project members
      operationId: AdminService_ListProjectMembers
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListProjectMembersResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organization
          in: path
          required: true
          type: string
        - name: project
          in: path
          required: true
          type: string
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int64
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - AdminService
    post:
      summary: AddProjectMember adds a member to the project
      operationId: AdminService_AddProjectMember
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1AddProjectMemberResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organization
          in: path
          required: true
          type: string
        - name: project
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              email:
                type: string
              role:
                type: string
            title: Request message for AdminService.AddProjectMember
      tags:
        - AdminService
  /v1/organizations/{organization}/projects/{project}/members/{email}:
    delete:
      summary: RemoveProjectMember removes member from the project
      operationId: AdminService_RemoveProjectMember
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1RemoveProjectMemberResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organization
          in: path
          required: true
          type: string
        - name: project
          in: path
          required: true
          type: string
        - name: email
          in: path
          required: true
          type: string
      tags:
        - AdminService
    put:
      summary: SetProjectMemberRole sets the role for the member
      operationId: AdminService_SetProjectMemberRole
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1SetProjectMemberRoleResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organization
          in: path
          required: true
          type: string
        - name: project
          in: path
          required: true
          type: string
        - name: email
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              role:
                type: string
            title: Request message for AdminService.SetProjectMemberRole
      tags:
        - AdminService
  /v1/organizations/{organizationName}/projects:
    get:
      summary: ListProjectsForOrganization lists all the projects currently available for given organizations
      operationId: AdminService_ListProjectsForOrganization
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListProjectsForOrganizationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int64
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - AdminService
    post:
      summary: CreateProject creates a new project
      operationId: AdminService_CreateProject
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateProjectResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              description:
                type: string
              githubUrl:
                type: string
              name:
                type: string
              productionBranch:
                type: string
              productionOlapDriver:
                type: string
              productionOlapDsn:
                type: string
              productionSlots:
                type: string
                format: int64
              public:
                type: boolean
              region:
                type: string
              variables:
                type: object
                additionalProperties:
                  type: string
      tags:
        - AdminService
  /v1/organizations/{organizationName}/projects/{name}:
    get:
      summary: GetProject returns information about a specific project
      operationId: AdminService_GetProject
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetProjectResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: name
          in: path
          required: true
          type: string
      tags:
        - AdminService
    delete:
      summary: DeleteProject deletes an project
      operationId: AdminService_DeleteProject
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1DeleteProjectResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: name
          in: path
          required: true
          type: string
      tags:
        - AdminService
    put:
      summary: UpdateProject updates a project
      operationId: AdminService_UpdateProject
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1UpdateProjectResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: name
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              description:
                type: string
              githubUrl:
                type: string
              productionBranch:
                type: string
              public:
                type: boolean
      tags:
        - AdminService
  /v1/organizations/{organizationName}/projects/{name}/variables:
    get:
      summary: 'GetProjectVariables returns project variables. NOTE: Get project API doesn''t return variables.'
      operationId: AdminService_GetProjectVariables
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetProjectVariablesResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: name
          in: path
          required: true
          type: string
      tags:
        - AdminService
    put:
      summary: 'UpdateProjectVariables updates variables for a project. NOTE: Update project API doesn''t update variables.'
      operationId: AdminService_UpdateProjectVariables
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1UpdateProjectVariablesResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: name
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              variables:
                type: object
                additionalProperties:
                  type: string
      tags:
        - AdminService
  /v1/organizations/{organizationName}/projects_by_github_url:
    get:
      summary: SearchProjects searched projects based on query passed
      operationId: AdminService_ListProjectsForOrganizationAndGithubURL
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListProjectsForOrganizationAndGithubURLResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: githubUrl
          in: query
          required: false
          type: string
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int64
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - AdminService
  /v1/ping:
    get:
      summary: Ping returns information about the server
      operationId: AdminService_Ping
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1PingResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      tags:
        - AdminService
  /v1/tokens/current:
    delete:
      summary: RevokeCurrentAuthToken revoke the current auth token
      operationId: AdminService_RevokeCurrentAuthToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1RevokeCurrentAuthTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      tags:
        - AdminService
  /v1/users/current:
    get:
      summary: GetCurrentUser returns the currently authenticated user (if any)
      operationId: AdminService_GetCurrentUser
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetCurrentUserResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      tags:
        - AdminService
definitions:
  protobufAny:
    type: object
    properties:
      '@type':
        type: string
    additionalProperties: {}
  rpcStatus:
    type: object
    properties:
      code:
        type: integer
        format: int32
      details:
        type: array
        items:
          $ref: '#/definitions/protobufAny'
      message:
        type: string
  v1AddOrganizationMemberResponse:
    type: object
    properties:
      pendingSignup:
        type: boolean
    title: Response message for AdminService.AddOrganizationMember
  v1AddProjectMemberResponse:
    type: object
    properties:
      pendingSignup:
        type: boolean
    title: Response message for AdminService.AddProjectMember
  v1CreateOrganizationRequest:
    type: object
    properties:
      description:
        type: string
      name:
        type: string
  v1CreateOrganizationResponse:
    type: object
    properties:
      organization:
        $ref: '#/definitions/v1Organization'
  v1CreateProjectResponse:
    type: object
    properties:
      project:
        $ref: '#/definitions/v1Project'
      projectUrl:
        type: string
  v1DeleteOrganizationResponse:
    type: object
  v1DeleteProjectResponse:
    type: object
  v1Deployment:
    type: object
    properties:
      branch:
        type: string
      createdOn:
        type: string
        format: date-time
      id:
        type: string
      logs:
        type: string
      projectId:
        type: string
      runtimeHost:
        type: string
      runtimeInstanceId:
        type: string
      slots:
        type: string
        format: int64
      status:
        $ref: '#/definitions/v1DeploymentStatus'
      updatedOn:
        type: string
        format: date-time
  v1DeploymentStatus:
    type: string
    enum:
      - DEPLOYMENT_STATUS_UNSPECIFIED
      - DEPLOYMENT_STATUS_PENDING
      - DEPLOYMENT_STATUS_OK
      - DEPLOYMENT_STATUS_RECONCILING
      - DEPLOYMENT_STATUS_ERROR
    default: DEPLOYMENT_STATUS_UNSPECIFIED
  v1GetCurrentUserResponse:
    type: object
    properties:
      user:
        $ref: '#/definitions/v1User'
  v1GetGithubRepoStatusResponse:
    type: object
    properties:
      defaultBranch:
        type: string
      grantAccessUrl:
        type: string
      hasAccess:
        type: boolean
  v1GetOrganizationResponse:
    type: object
    properties:
      organization:
        $ref: '#/definitions/v1Organization'
      permissions:
        $ref: '#/definitions/v1OrganizationPermissions'
  v1GetProjectResponse:
    type: object
    properties:
      jwt:
        type: string
      productionDeployment:
        $ref: '#/definitions/v1Deployment'
      project:
        $ref: '#/definitions/v1Project'
      projectPermissions:
        $ref: '#/definitions/v1ProjectPermissions'
  v1GetProjectVariablesResponse:
    type: object
    properties:
      variables:
        type: object
        additionalProperties:
          type: string
  v1LeaveOrganizationResponse:
    type: object
    title: Response message for AdminService.LeaveOrganization
  v1ListOrganizationMembersResponse:
    type: object
    properties:
      invites:
        type: array
        items:
          $ref: '#/definitions/v1UserInvite'
      members:
        type: array
        items:
          $ref: '#/definitions/v1Member'
      nextPageToken:
        type: string
    title: Response message for AdminService.ListOrganizationMembers
  v1ListOrganizationsResponse:
    type: object
    properties:
      nextPageToken:
        type: string
      organizations:
        type: array
        items:
          $ref: '#/definitions/v1Organization'
  v1ListProjectMembersResponse:
    type: object
    properties:
      invites:
        type: array
        items:
          $ref: '#/definitions/v1UserInvite'
      members:
        type: array
        items:
          $ref: '#/definitions/v1Member'
      nextPageToken:
        type: string
    title: Response message for AdminService.ListProjectMembers
  v1ListProjectsForOrganizationAndGithubURLResponse:
    type: object
    properties:
      nextPageToken:
        type: string
      projects:
        type: array
        items:
          $ref: '#/definitions/v1Project'
  v1ListProjectsForOrganizationResponse:
    type: object
    properties:
      nextPageToken:
        type: string
      projects:
        type: array
        items:
          $ref: '#/definitions/v1Project'
  v1Member:
    type: object
    properties:
      createdOn:
        type: string
        format: date-time
      roleName:
        type: string
      updatedOn:
        type: string
        format: date-time
      userEmail:
        type: string
      userId:
        type: string
      userName:
        type: string
  v1Organization:
    type: object
    properties:
      createdOn:
        type: string
        format: date-time
      description:
        type: string
      id:
        type: string
      name:
        type: string
        title: Globally unique
      updatedOn:
        type: string
        format: date-time
  v1OrganizationPermissions:
    type: object
    properties:
      createProjects:
        type: boolean
      manageOrg:
        type: boolean
      manageOrgMembers:
        type: boolean
      manageProjects:
        type: boolean
      readOrg:
        type: boolean
      readOrgMembers:
        type: boolean
      readProjects:
        type: boolean
  v1PingResponse:
    type: object
    properties:
      time:
        type: string
        format: date-time
      version:
        type: string
  v1Project:
    type: object
    properties:
      createdOn:
        type: string
        format: date-time
      description:
        type: string
      githubUrl:
        type: string
      id:
        type: string
      name:
        type: string
        title: Unique in organization
      orgId:
        type: string
      orgName:
        type: string
      productionBranch:
        type: string
      productionDeploymentId:
        type: string
      productionOlapDriver:
        type: string
      productionOlapDsn:
        type: string
      productionSlots:
        type: string
        format: int64
      public:
        type: boolean
      region:
        type: string
      updatedOn:
        type: string
        format: date-time
  v1ProjectPermissions:
    type: object
    properties:
      manageDevBranches:
        type: boolean
      manageProdBranch:
        type: boolean
      manageProject:
        type: boolean
      manageProjectMembers:
        type: boolean
      readDevBranches:
        type: boolean
      readProdBranch:
        type: boolean
      readProject:
        type: boolean
      readProjectMembers:
        type: boolean
  v1RemoveOrganizationMemberResponse:
    type: object
    title: Response message for AdminService.RemoveOrganizationMember
  v1RemoveProjectMemberResponse:
    type: object
    title: Response message for AdminService.RemoveProjectMember
  v1RevokeCurrentAuthTokenResponse:
    type: object
    properties:
      tokenId:
        type: string
  v1SetOrganizationMemberRoleResponse:
    type: object
    title: Response message for AdminService.SetOrganizationMemberRole
  v1SetProjectMemberRoleResponse:
    type: object
    title: Response message for AdminService.SetProjectMemberRole
  v1UpdateOrganizationResponse:
    type: object
    properties:
      organization:
        $ref: '#/definitions/v1Organization'
  v1UpdateProjectResponse:
    type: object
    properties:
      project:
        $ref: '#/definitions/v1Project'
  v1UpdateProjectVariablesResponse:
    type: object
    properties:
      variables:
        type: object
        additionalProperties:
          type: string
  v1User:
    type: object
    properties:
      createdOn:
        type: string
        format: date-time
      displayName:
        type: string
      email:
        type: string
      id:
        type: string
      photoUrl:
        type: string
      updatedOn:
        type: string
        format: date-time
  v1UserInvite:
    type: object
    properties:
      email:
        type: string
      invitedBy:
        type: string
      role:
        type: string
