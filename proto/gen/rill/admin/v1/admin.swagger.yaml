swagger: "2.0"
info:
  title: rill/admin/v1/api.proto
  version: version not set
tags:
  - name: AdminService
consumes:
  - application/json
produces:
  - application/json
paths:
  /v1/github/repositories:
    get:
      summary: |-
        GetGithubRepoRequest returns info about a Github repo based on the caller's installations.
        If the caller has not granted access to the repository, instructions for granting access are returned.
      operationId: AdminService_GetGithubRepoStatus
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetGithubRepoStatusResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: githubUrl
          in: query
          required: false
          type: string
      tags:
        - AdminService
  /v1/organizations:
    get:
      summary: ListOrganizations lists all the organizations currently managed by the admin
      operationId: AdminService_ListOrganizations
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListOrganizationsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int64
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - AdminService
    post:
      summary: CreateOrganization creates a new organization
      operationId: AdminService_CreateOrganization
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateOrganizationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateOrganizationRequest'
      tags:
        - AdminService
  /v1/organizations/{name}:
    get:
      summary: GetOrganization returns information about a specific organization
      operationId: AdminService_GetOrganization
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetOrganizationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: name
          in: path
          required: true
          type: string
      tags:
        - AdminService
    delete:
      summary: DeleteOrganization deletes an organizations
      operationId: AdminService_DeleteOrganization
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1DeleteOrganizationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: name
          in: path
          required: true
          type: string
      tags:
        - AdminService
    put:
      summary: UpdateOrganization deletes an organizations
      operationId: AdminService_UpdateOrganization
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1UpdateOrganizationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: name
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              description:
                type: string
      tags:
        - AdminService
  /v1/organizations/{organizationName}/projects:
    get:
      summary: ListProjects lists all the projects currently available for given organizations
      operationId: AdminService_ListProjects
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListProjectsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int64
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - AdminService
    post:
      summary: CreateProject creates a new project
      operationId: AdminService_CreateProject
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateProjectResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              description:
                type: string
              githubUrl:
                type: string
              label:
                type: string
                title: A label to identify a specific deployment. <cloud provider>-<region>
              name:
                type: string
              productionBranch:
                type: string
              productionSlots:
                type: string
                format: int64
              public:
                type: boolean
              variables:
                type: object
                additionalProperties:
                  type: string
      tags:
        - AdminService
  /v1/organizations/{organizationName}/projects/{name}:
    get:
      summary: GetProject returns information about a specific project
      operationId: AdminService_GetProject
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetProjectResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: name
          in: path
          required: true
          type: string
      tags:
        - AdminService
    delete:
      summary: DeleteProject deletes an project
      operationId: AdminService_DeleteProject
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1DeleteProjectResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: name
          in: path
          required: true
          type: string
      tags:
        - AdminService
    put:
      summary: UpdateProject updates a project
      operationId: AdminService_UpdateProject
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1UpdateProjectResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: organizationName
          in: path
          required: true
          type: string
        - name: name
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              description:
                type: string
              githubUrl:
                type: string
              productionBranch:
                type: string
              public:
                type: boolean
              variables:
                type: object
                additionalProperties:
                  type: string
      tags:
        - AdminService
  /v1/ping:
    get:
      summary: Ping returns information about the server
      operationId: AdminService_Ping
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1PingResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      tags:
        - AdminService
  /v1/tokens/current:
    delete:
      summary: RevokeCurrentAuthToken revoke the current auth token
      operationId: AdminService_RevokeCurrentAuthToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1RevokeCurrentAuthTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      tags:
        - AdminService
  /v1/users/current:
    get:
      summary: GetCurrentUser returns the currently authenticated user (if any)
      operationId: AdminService_GetCurrentUser
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetCurrentUserResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      tags:
        - AdminService
definitions:
  protobufAny:
    type: object
    properties:
      '@type':
        type: string
    additionalProperties: {}
  rpcStatus:
    type: object
    properties:
      code:
        type: integer
        format: int32
      details:
        type: array
        items:
          $ref: '#/definitions/protobufAny'
      message:
        type: string
  v1CreateOrganizationRequest:
    type: object
    properties:
      description:
        type: string
      id:
        type: string
      name:
        type: string
  v1CreateOrganizationResponse:
    type: object
    properties:
      organization:
        $ref: '#/definitions/v1Organization'
  v1CreateProjectResponse:
    type: object
    properties:
      project:
        $ref: '#/definitions/v1Project'
  v1DeleteOrganizationResponse:
    type: object
  v1DeleteProjectResponse:
    type: object
  v1Deployment:
    type: object
    properties:
      branch:
        type: string
      createdOn:
        type: string
        format: date-time
      id:
        type: string
      logs:
        type: string
      projectId:
        type: string
      runtimeHost:
        type: string
      runtimeInstanceId:
        type: string
      slots:
        type: string
        format: int64
      status:
        $ref: '#/definitions/v1DeploymentStatus'
      updatedOn:
        type: string
        format: date-time
  v1DeploymentStatus:
    type: string
    enum:
      - DEPLOYMENT_STATUS_UNSPECIFIED
      - DEPLOYMENT_STATUS_PENDING
      - DEPLOYMENT_STATUS_OK
      - DEPLOYMENT_STATUS_RECONCILING
      - DEPLOYMENT_STATUS_ERROR
    default: DEPLOYMENT_STATUS_UNSPECIFIED
  v1GetCurrentUserResponse:
    type: object
    properties:
      user:
        $ref: '#/definitions/v1User'
  v1GetGithubRepoStatusResponse:
    type: object
    properties:
      defaultBranch:
        type: string
      grantAccessUrl:
        type: string
      hasAccess:
        type: boolean
  v1GetOrganizationResponse:
    type: object
    properties:
      organization:
        $ref: '#/definitions/v1Organization'
  v1GetProjectResponse:
    type: object
    properties:
      jwt:
        type: string
      productionDeployment:
        $ref: '#/definitions/v1Deployment'
      project:
        $ref: '#/definitions/v1Project'
  v1ListOrganizationsResponse:
    type: object
    properties:
      nextPageToken:
        type: string
      organizations:
        type: array
        items:
          $ref: '#/definitions/v1Organization'
  v1ListProjectsResponse:
    type: object
    properties:
      nextPageToken:
        type: string
      projects:
        type: array
        items:
          $ref: '#/definitions/v1Project'
  v1Organization:
    type: object
    properties:
      createdOn:
        type: string
        format: date-time
      description:
        type: string
      id:
        type: string
      name:
        type: string
        title: Globally unique
      updatedOn:
        type: string
        format: date-time
  v1PingResponse:
    type: object
    properties:
      time:
        type: string
        format: date-time
      version:
        type: string
  v1Project:
    type: object
    properties:
      createdOn:
        type: string
        format: date-time
      description:
        type: string
      githubUrl:
        type: string
      id:
        type: string
      name:
        type: string
        title: Unique in organization
      productionBranch:
        type: string
      productionDeploymentId:
        type: string
      productionSlots:
        type: string
        format: int64
      public:
        type: boolean
      updatedOn:
        type: string
        format: date-time
      variables:
        type: object
        additionalProperties:
          type: string
  v1RevokeCurrentAuthTokenResponse:
    type: object
    properties:
      tokenId:
        type: string
  v1UpdateOrganizationResponse:
    type: object
    properties:
      organization:
        $ref: '#/definitions/v1Organization'
  v1UpdateProjectResponse:
    type: object
    properties:
      project:
        $ref: '#/definitions/v1Project'
  v1User:
    type: object
    properties:
      createdOn:
        type: string
        format: date-time
      displayName:
        type: string
      email:
        type: string
      id:
        type: string
      photoUrl:
        type: string
      updatedOn:
        type: string
        format: date-time
